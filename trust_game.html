<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trust Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      max-width: 1000px;
      margin: auto;
      background-color: #fff;
      line-height: 1.6;
    }
    .summary-text {
      font-size: 18px;
      font-weight: bold;
      margin: 10px 0;
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      background-color: #27ae60;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2ecc71;
    }
  </style>
</head>
<body>

<h3 id="roundHeader"></h3>

<div id="waitingScreen" style="display: block; font-weight: bold; font-size: 20px; margin-bottom: 20px;">
  Waiting for the decision of next Player A...
</div>

<div id="gameContent" style="display: none;">
  <p class="summary-text">Amount you sent: <span id="sentAmount"></span></p>
  <p class="summary-text">Tripled by the system: <span id="tripledAmount"></span></p>
  <p class="summary-text">Amount returned by Player B: <span id="returnedAmount"></span></p>
  <p class="summary-text">Total amount you receive: <span id="finalAmount"></span></p>

  <br>
  <button onclick="submitDecision()">Continue</button>
</div>

<script>
  let currentRound = parseInt(localStorage.getItem("TrustTrial") || "1");
  const totalRounds = 10;
  const roundResults = JSON.parse(localStorage.getItem("TrustResults") || "[]");

  const amountSent = 7;
  const amountTripled = amountSent * 3;
  const amountReturned = 4; // placeholder
  const finalAmount = amountReturned + (12 - amountSent);

  function updateGameContent() {
    document.getElementById("roundHeader").textContent = `Round ${currentRound} of ${totalRounds}`;
    document.getElementById("sentAmount").textContent = `${amountSent} 칑 游리`;
    document.getElementById("tripledAmount").textContent = `${amountTripled} 칑 游리`;
    document.getElementById("returnedAmount").textContent = `${amountReturned} 칑 游리`;
    document.getElementById("finalAmount").textContent = `${finalAmount} 칑 游리`;
  }

  function showGameAfterDelay() {
    document.getElementById("waitingScreen").style.display = "block";
    document.getElementById("gameContent").style.display = "none";
    setTimeout(() => {
      updateGameContent();
      document.getElementById("waitingScreen").style.display = "none";
      document.getElementById("gameContent").style.display = "block";
    }, 1500);
  }

  function submitDecision() {
    roundResults.push({
      round: currentRound,
      sent: amountSent,
      returned: amountReturned,
      final: finalAmount
    });
    currentRound++;
    if (currentRound > totalRounds) {
      localStorage.setItem("TrustResults", JSON.stringify(roundResults));
      localStorage.setItem("TrustTrial", "1");
      window.location.href = "next_page.html"; // Change as needed
    } else {
      localStorage.setItem("TrustTrial", currentRound.toString());
      location.reload();
    }
  }

  document.addEventListener("DOMContentLoaded", showGameAfterDelay);
</script>

</body>
</html>
